<template>
  <form class="w-11/12 flex justify-between gap-3">
    <div class="w-[89%] rounded-[10px] h-[38px] flex justify-between items-center bg-secondary1">
      <input
        v-model="inputComment"
        required
        type="text"
        placeholder="Write a comment..."
        class="h-full w-full px-3 bg-[initial] outline-none placeholder:text-secondary2 placeholder:text-sm"
      />

      <div class="flex gap-2 pr-2">
        <!-- icon fileupload -->
        <button type="button" @click="triggerInputFile($event)">
          <input
            type="file"
            @change="changeInptFile"
            ref="file_comment"
            class="hidden"
            :name="'comment_file' + postIdx"
          />
          <svg
            class="pointer-events-none"
            width="16"
            height="16"
            viewBox="0 0 16 16"
            fill="none"
            xmlns="http://www.w3.org/2000/svg"
          >
            <path
              d="M2.2624 14.9845L2.2464 15L2.2296 14.9845H0.7936C0.583051 14.9843 0.381197 14.9029 0.232392 14.7582C0.0835856 14.6136 -1.06764e-07 14.4175 0 14.213V1.77148C0.00146404 1.56744 0.0855202 1.37216 0.23401 1.22781C0.3825 1.08345 0.583504 1.00163 0.7936 1H15.2064C15.6448 1 16 1.34573 16 1.77148V14.213C15.9985 14.417 15.9145 14.6123 15.766 14.7567C15.6175 14.901 15.4165 14.9828 15.2064 14.9845H2.2624ZM14.4 10.323V2.55383H1.6V13.4306L9.6 5.66149L14.4 10.323ZM14.4 12.5201L9.6 7.8586L3.8624 13.4306H14.4V12.5201ZM4.8 7.21532C4.37565 7.21532 3.96869 7.05161 3.66863 6.76021C3.36857 6.46881 3.2 6.07359 3.2 5.66149C3.2 5.24939 3.36857 4.85416 3.66863 4.56276C3.96869 4.27136 4.37565 4.10766 4.8 4.10766C5.22435 4.10766 5.63131 4.27136 5.93137 4.56276C6.23143 4.85416 6.4 5.24939 6.4 5.66149C6.4 6.07359 6.23143 6.46881 5.93137 6.76021C5.63131 7.05161 5.22435 7.21532 4.8 7.21532Z"
              fill="white"
            />
            <path
              d="M2.2624 14.9845L2.2464 15L2.2296 14.9845H0.7936C0.583051 14.9843 0.381197 14.9029 0.232392 14.7582C0.0835856 14.6136 -1.06764e-07 14.4175 0 14.213V1.77148C0.00146404 1.56744 0.0855202 1.37216 0.23401 1.22781C0.3825 1.08345 0.583504 1.00163 0.7936 1H15.2064C15.6448 1 16 1.34573 16 1.77148V14.213C15.9985 14.417 15.9145 14.6123 15.766 14.7567C15.6175 14.901 15.4165 14.9828 15.2064 14.9845H2.2624ZM14.4 10.323V2.55383H1.6V13.4306L9.6 5.66149L14.4 10.323ZM14.4 12.5201L9.6 7.8586L3.8624 13.4306H14.4V12.5201ZM4.8 7.21532C4.37565 7.21532 3.96869 7.05161 3.66863 6.76021C3.36857 6.46881 3.2 6.07359 3.2 5.66149C3.2 5.24939 3.36857 4.85416 3.66863 4.56276C3.96869 4.27136 4.37565 4.10766 4.8 4.10766C5.22435 4.10766 5.63131 4.27136 5.93137 4.56276C6.23143 4.85416 6.4 5.24939 6.4 5.66149C6.4 6.07359 6.23143 6.46881 5.93137 6.76021C5.63131 7.05161 5.22435 7.21532 4.8 7.21532Z"
              fill="#4E5D78"
            />
          </svg>
        </button>
        <!-- icon emoij -->
        <div class="flex items-center">
          <button @click="isShowEmoij = !isShowEmoij" type="button">
            <svg
              class="pointer-events-none"
              width="16"
              height="16"
              viewBox="0 0 16 16"
              fill="none"
              xmlns="http://www.w3.org/2000/svg"
            >
              <path
                d="M8 16C3.5816 16 0 12.4184 0 8C0 3.5816 3.5816 0 8 0C12.4184 0 16 3.5816 16 8C16 12.4184 12.4184 16 8 16ZM8 14.4C9.69739 14.4 11.3253 13.7257 12.5255 12.5255C13.7257 11.3253 14.4 9.69739 14.4 8C14.4 6.30261 13.7257 4.67475 12.5255 3.47452C11.3253 2.27428 9.69739 1.6 8 1.6C6.30261 1.6 4.67475 2.27428 3.47452 3.47452C2.27428 4.67475 1.6 6.30261 1.6 8C1.6 9.69739 2.27428 11.3253 3.47452 12.5255C4.67475 13.7257 6.30261 14.4 8 14.4ZM4 8H5.6C5.6 8.63652 5.85286 9.24697 6.30294 9.69706C6.75303 10.1471 7.36348 10.4 8 10.4C8.63652 10.4 9.24697 10.1471 9.69706 9.69706C10.1471 9.24697 10.4 8.63652 10.4 8H12C12 9.06087 11.5786 10.0783 10.8284 10.8284C10.0783 11.5786 9.06087 12 8 12C6.93913 12 5.92172 11.5786 5.17157 10.8284C4.42143 10.0783 4 9.06087 4 8Z"
                fill="white"
              />
              <path
                d="M8 16C3.5816 16 0 12.4184 0 8C0 3.5816 3.5816 0 8 0C12.4184 0 16 3.5816 16 8C16 12.4184 12.4184 16 8 16ZM8 14.4C9.69739 14.4 11.3253 13.7257 12.5255 12.5255C13.7257 11.3253 14.4 9.69739 14.4 8C14.4 6.30261 13.7257 4.67475 12.5255 3.47452C11.3253 2.27428 9.69739 1.6 8 1.6C6.30261 1.6 4.67475 2.27428 3.47452 3.47452C2.27428 4.67475 1.6 6.30261 1.6 8C1.6 9.69739 2.27428 11.3253 3.47452 12.5255C4.67475 13.7257 6.30261 14.4 8 14.4ZM4 8H5.6C5.6 8.63652 5.85286 9.24697 6.30294 9.69706C6.75303 10.1471 7.36348 10.4 8 10.4C8.63652 10.4 9.24697 10.1471 9.69706 9.69706C10.1471 9.24697 10.4 8.63652 10.4 8H12C12 9.06087 11.5786 10.0783 10.8284 10.8284C10.0783 11.5786 9.06087 12 8 12C6.93913 12 5.92172 11.5786 5.17157 10.8284C4.42143 10.0783 4 9.06087 4 8Z"
                fill="#4E5D78"
              />
            </svg>
          </button>
          <div
          class="absolute right-[13%] bottom-[12%] md:bottom-[10%] md:left-[20%] lg:left-[33%] z-50">
            <VuemojiPicker v-if="isShowEmoij" @emojiClick="onSelectEmoji" />
          </div>
        </div>
      </div>
    </div>
    <button
      class="btn-submit flex justify-center items-center bg-secondary1 rounded-[5px] w-[38px] h-[38px] hover:bg-secondary-33"
    >
      <svg
        width="16"
        height="16"
        viewBox="0 0 16 16"
        fill="none"
        xmlns="http://www.w3.org/2000/svg"
      >
        <path
          d="M0.609192 0.0464914L15.7872 7.67111C15.8516 7.70352 15.9054 7.75113 15.9428 7.80898C15.9803 7.86683 16 7.9328 16 8C16 8.0672 15.9803 8.13317 15.9428 8.19102C15.9054 8.24887 15.8516 8.29648 15.7872 8.32889L0.609192 15.9535C0.546607 15.985 0.47613 16.001 0.404708 16C0.333286 15.9989 0.263385 15.981 0.201894 15.9478C0.140403 15.9146 0.089444 15.8673 0.0540409 15.8106C0.0186378 15.754 1.22294e-05 15.6899 0 15.6246V0.375385C1.22294e-05 0.310143 0.0186378 0.24603 0.0540409 0.189365C0.089444 0.1327 0.140403 0.0854393 0.201894 0.0522411C0.263385 0.0190429 0.333286 0.00105307 0.404708 4.48448e-05C0.47613 -0.000963385 0.546607 0.0150448 0.609192 0.0464914ZM1.64424 8.7509V13.7196L13.0306 8L1.64424 2.28041V7.2491H5.75485V8.7509H1.64424Z"
          fill="#377DFF"
        />
      </svg>
    </button>
  </form>
</template>

<script lang="ts" setup>
import { ref } from 'vue';
import { VuemojiPicker } from 'vuemoji-picker';

const props = defineProps({
    post: Number,
    postIdx: Number
});

const inputComment = ref('')
const isShowEmoij = ref(false)
const file_comment_preview = ref('')

const onSelectEmoji = (emoji: any) => {
  console.log(emoji.unicode)
  inputComment.value += emoji.unicode
}

const triggerInputFile = (e: {}) => {
  try {
    let inptFile = e.target.querySelector('input[type=file]')
    inptFile.click()
  } catch (e) {
    console.log(e)
  }
}
const changeInptFile = (e: HTMLInputElement, postIdx: Number) => {
  let input = e.target.getAttribute('name')
  this.previewFileComment(input)
}
</script>
